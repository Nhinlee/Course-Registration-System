-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE public.ministry_account
(
    ministry_id character varying(45) NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    PRIMARY KEY (ministry_id)
);

CREATE TABLE public.student
(
    student_id character varying(10) NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    full_name text NOT NULL,
    birth_day date,
    address text,
    class_id character varying(45) NOT NULL,
    PRIMARY KEY (student_id)
);

CREATE TABLE public.subject
(
    subject_id character varying(45) NOT NULL,
    subject_name text NOT NULL,
    number_of_credits smallint NOT NULL,
    PRIMARY KEY (subject_id)
);

CREATE TABLE public.semester
(
    semester_id character varying(45) NOT NULL,
    semester_name character varying(45) NOT NULL,
    school_year character varying(45) NOT NULL,
    start_date date NOT NULL,
    end_date date NOT NULL,
    is_current boolean,
    PRIMARY KEY (semester_id)
);

CREATE TABLE public.class
(
    class_id character varying(45) NOT NULL,
    male_students smallint NOT NULL,
    female_students smallint NOT NULL,
    PRIMARY KEY (class_id)
);

CREATE TABLE public.course
(
    course_id character varying(45) NOT NULL,
    course_name text NOT NULL,
    subject_id character varying(45) NOT NULL,
    lecturers_full_name text NOT NULL,
    max_slot smallint NOT NULL,
    room_name text,
    day_of_week smallint,
    part_of_day smallint,
    semester_id character varying(45) NOT NULL,
    PRIMARY KEY (course_id)
);

CREATE TABLE public.course_registration_session
(
    session_id character varying(45) NOT NULL,
    start_date date NOT NULL,
    end_date date NOT NULL,
    semester_id character varying(45) NOT NULL,
    PRIMARY KEY (session_id)
);

CREATE TABLE public.course_student
(
    course_course_id character varying(45) NOT NULL,
    student_student_id character varying(10) NOT NULL
);

ALTER TABLE public.course_student
    ADD FOREIGN KEY (course_course_id)
    REFERENCES public.course (course_id)
    NOT VALID;


ALTER TABLE public.course_student
    ADD FOREIGN KEY (student_student_id)
    REFERENCES public.student (student_id)
    NOT VALID;


ALTER TABLE public.course
    ADD FOREIGN KEY (subject_id)
    REFERENCES public.subject (subject_id)
    NOT VALID;


ALTER TABLE public.course
    ADD FOREIGN KEY (semester_id)
    REFERENCES public.semester (semester_id)
    NOT VALID;


ALTER TABLE public.course_registration_session
    ADD FOREIGN KEY (semester_id)
    REFERENCES public.semester (semester_id)
    NOT VALID;


ALTER TABLE public.student
    ADD FOREIGN KEY (class_id)
    REFERENCES public.class (class_id)
    NOT VALID;

END;